QUICK START GUIDE - STELLAR MILESTONE ESCROW
============================================

CURRENT STATUS:
✓ Backend: RUNNING on port 3001
✓ Frontend: Ready to start
✓ All routes fixed
✓ Role-based security enabled


STEP 1: START FRONTEND
=======================

Open a new terminal and run:

cd frontend
npm run dev

Frontend will start on: http://localhost:5173


STEP 2: CONNECT WALLET
=======================

1. Open http://localhost:5173 in your browser
2. Click "Connect Wallet" button
3. Freighter wallet will open
4. Approve the connection
5. You'll see your wallet address in the navbar


STEP 3: CREATE MILESTONE (AS CLIENT)
=====================================

1. Make sure you're in BUYING mode (check badge in navbar)
2. Click "Create Milestone" in navbar
3. Enter freelancer wallet address (use a different test wallet)
4. Enter amount (e.g., 10 XLM)
5. Click "Create Milestone"
6. Sign the transaction in Freighter
7. Wait for confirmation
8. You'll be redirected to dashboard


STEP 4: FUND MILESTONE (AS CLIENT)
===================================

1. In BUYING mode, you'll see your created milestone
2. Click on the milestone card
3. Click "Fund Milestone" button
4. Sign the transaction in Freighter
5. Wait for confirmation
6. Status changes to FUNDED
7. XLM is now locked in the smart contract


STEP 5: SUBMIT WORK (AS FREELANCER)
====================================

1. Switch to SELLING mode (click mode switcher in navbar)
2. You'll see the funded milestone
3. Click on the milestone
4. Enter submission details (work description, links, etc.)
5. Click "Submit Work"
6. Sign the transaction in Freighter
7. Status changes to SUBMITTED


STEP 6: APPROVE & RELEASE (AS CLIENT)
======================================

1. Switch back to BUYING mode
2. Click on the submitted milestone
3. Review the submission details
4. Click "Approve & Release" button
5. Sign the transaction in Freighter
6. Wait for confirmation
7. XLM is released to freelancer's wallet
8. Status changes to APPROVED


TESTING ROLE-BASED SECURITY
============================

Try these to verify security:

1. In SELLING mode, try to access /create-milestone
   → Should show error or redirect

2. Try to fund a milestone you don't own
   → Should get 403 Forbidden error

3. Try to submit work for a milestone not assigned to you
   → Should get 403 Forbidden error

4. Try to approve a milestone you're not the client of
   → Should get 403 Forbidden error

5. Switch modes and verify data changes
   → BUYING mode: only see milestones where you're client
   → SELLING mode: only see milestones where you're freelancer


CHECKING BACKEND LOGS
======================

Watch the backend terminal for access logs:

[ACCESS] CREATE_MILESTONE - Wallet: GDYCJYHG... - Mode: BUYING - IP: ::1
[ACCESS] FUND_MILESTONE - Wallet: GDYCJYHG... - Mode: BUYING - IP: ::1
[ACCESS] SUBMIT_WORK - Wallet: GBDEVU63... - Mode: SELLING - IP: ::1
[ACCESS] APPROVE_MILESTONE - Wallet: GDYCJYHG... - Mode: BUYING - IP: ::1

This confirms role-based middleware is working!


VERIFYING BLOCKCHAIN TRANSACTIONS
==================================

1. After each transaction, click the transaction hash link
2. It opens Stellar Explorer
3. Verify:
   - Transaction is confirmed
   - Correct amount transferred
   - Correct addresses involved
   - Contract address visible


TROUBLESHOOTING
===============

Issue: "Route not found" error
Solution: Backend was restarted, frontend needs refresh
Action: Hard refresh browser (Ctrl+Shift+R)

Issue: "Wallet address required" error
Solution: Mode or wallet not being sent
Action: Check browser console for errors

Issue: "Access denied" error
Solution: Wrong mode or not authorized
Action: Switch to correct mode or use correct wallet

Issue: Transaction fails
Solution: Insufficient XLM or network issue
Action: Check wallet balance, try again


WHAT TO EXPECT
==============

✓ Clean separation between BUYING and SELLING modes
✓ Only see your own milestones in each mode
✓ Cannot perform actions you're not authorized for
✓ Real XLM transfers visible in Freighter wallet
✓ All transactions recorded on Stellar blockchain
✓ Transaction hashes link to Stellar Explorer
✓ Access logs in backend console
✓ Clear error messages for unauthorized access


NEXT STEPS
==========

After successful testing:

1. Run database migration:
   - Execute backend/supabase-add-milestone-tx-fields.sql

2. Test with real contract:
   - Set USE_REAL_CONTRACT=true in backend/.env
   - Set CONTRACT_ID to your deployed contract

3. Test full flow multiple times

4. Monitor for any errors or issues

5. Ready for production deployment!


NEED HELP?
==========

Check these files:
- CONTRACT_VERIFICATION.txt - Contract function mapping
- TESTING_CHECKLIST.txt - Comprehensive test cases
- IMPLEMENTATION_SUMMARY.txt - Complete overview

Backend logs show all access attempts and errors.
Frontend console shows API calls and responses.
